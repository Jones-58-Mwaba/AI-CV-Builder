<!DOCTYPE html>
<html>
<head>
    <title>Create Your CV - AI CV Builder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Light gray background for the entire page */
        body {
            background: #a3a2a2ff;  /* Light gray background */
            min-height: 100vh;
            }

            .container.mt-5.pt-5 {
                                background: #dbd9d9ff;  /* White background for content area */
                                border-radius: 10px;
                                box-shadow: 0 0 20px rgba(0,0,0,0.1);
                                padding: 30px;
                                margin-bottom: 30px;
                            }

        .navbar-custom {
            background-color: #2c3e50;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }
        .form-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section-header {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        .btn-add {
            background: #27ae60;
            color: white;
            border: none;
        }
        .btn-add:hover {
            background: #219653;
        }
        .btn-ai {
            background: #8e44ad;
            color: white;
            border: none;
        }
        .btn-ai:hover {
            background: #7d3c98;
        }

        /* This is the hover and shodow effect on the save button */
        .save-btn {
              background: linear-gradient(135deg, #3498db, #2980b9);
              border: none;
              border-radius: 8px;
              transition: all 0.3s ease;
              box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            }

        .save-btn:hover {
                transform: translateY(-3px);
                box-shadow: 0 8px 25px rgba(52, 152, 219, 0.5);
                background: linear-gradient(135deg, #2980b9, #2471a3);
            }

            /* This is the hover and shodow effect on the download button*/
        .download-btn {
                background: linear-gradient(135deg, #27ae60, #219653);
                border: none;
                border-radius: 8px;
                transition: all 0.3s ease;
                box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
                }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.5);
            background: linear-gradient(135deg, #219653, #1e8449);
            }

        /* this is the click effect */
        .save-btn:active, .download-btn:active {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-custom fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold text-white" href="{% url 'dashboard' %}">
                <i class="fas fa-brain me-2"></i>AI CV Builder
            </a>
            <div class="navbar-nav ms-auto align-items-center">
                <span class="navbar-text text-white me-3">Editing: {{ cv.title }}</span>
                <a class="btn btn-outline-light btn-sm me-2" href="{% url 'dashboard' %}">‚Üê Dashboard</a>
                <a class="btn btn-outline-light btn-sm" href="{% url 'logout' %}">Logout</a>
            </div>
        </div>
    </nav>

    <!-- CV Editor -->
    <div class="container mt-5 pt-5">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">Create Your Professional CV</h1>
                
                <!-- Success Messages -->
                {% if messages %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    {% for message in messages %}
                        {{ message }}
                    {% endfor %}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
                {% endif %}
                
                <form method="POST" action="{% url 'edit_cv' cv.id %}">
                    {% csrf_token %}
                    
                    <!-- Personal Information -->
                    <div class="form-section">
                        <h3 class="section-header">
                            <i class="fas fa-user me-2"></i>Personal Information
                        </h3>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Full Name *</label>
                                <input type="text" class="form-control" name="full_name" value="{{ cv.full_name }}" placeholder="John Doe" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Email *</label>
                                <input type="email" class="form-control" name="email" value="{{ cv.email }}" placeholder="john@example.com" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Phone *</label>
                                <input type="tel" class="form-control" name="phone" value="{{ cv.phone }}" placeholder="+1234567890" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Location *</label>
                                <input type="text" class="form-control" name="location" value="{{ cv.location }}" placeholder="City, Country" required>
                            </div>
                            
                            <!-- Personal Details -->
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Date of Birth</label>
                                <input type="date" class="form-control" name="date_of_birth" value="{{ cv.date_of_birth|date:'Y-m-d' }}">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Gender</label>
                                <select class="form-select" name="gender">
                                    <option value="">Select Gender</option>
                                    <option value="male" {% if cv.gender == 'male' %}selected{% endif %}>Male</option>
                                    <option value="female" {% if cv.gender == 'female' %}selected{% endif %}>Female</option>
                                    <option value="other" {% if cv.gender == 'other' %}selected{% endif %}>Other</option>
                                    <option value="prefer_not_to_say" {% if cv.gender == 'prefer_not_to_say' %}selected{% endif %}>Prefer not to say</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Nationality</label>
                                <input type="text" class="form-control" name="nationality" value="{{ cv.nationality }}" placeholder="e.g., Zambian">
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Languages</label>
                                <input type="text" class="form-control" name="languages" value="{{ cv.languages }}" placeholder="e.g., English, Bemba, Nyanja">
                                <div class="form-text">Separate languages with commas</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Marital Status</label>
                                <select class="form-select" name="marital_status">
                                    <option value="">Select Status</option>
                                    <option value="single" {% if cv.marital_status == 'single' %}selected{% endif %}>Single</option>
                                    <option value="married" {% if cv.marital_status == 'married' %}selected{% endif %}>Married</option>
                                    <option value="divorced" {% if cv.marital_status == 'divorced' %}selected{% endif %}>Divorced</option>
                                    <option value="widowed" {% if cv.marital_status == 'widowed' %}selected{% endif %}>Widowed</option>
                                </select>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label class="form-label">LinkedIn Profile</label>
                                <input type="url" class="form-control" name="linkedin" value="{{ cv.linkedin_url }}" placeholder="https://linkedin.com/in/yourprofile">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">GitHub/Portfolio</label>
                                <input type="url" class="form-control" name="portfolio" value="{{ cv.github_url }}" placeholder="https://github.com/yourusername">
                            </div>
                            
                            <div class="col-12 mb-3">
                                <label class="form-label">Professional Summary</label>
                                <textarea class="form-control" name="professional_summary" rows="4" placeholder="Experienced professional with...">{{ cv.professional_summary }}</textarea>
                                <button type="button" class="btn btn-ai btn-sm mt-2">
                                    <i class="fas fa-robot me-1"></i>AI Enhance Summary
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Work Experience -->
                    <div class="form-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="section-header mb-0">
                                <i class="fas fa-briefcase me-2"></i>Work Experience
                            </h3>
                            <button type="button" class="btn btn-add" id="add-experience">
                                <i class="fas fa-plus me-1"></i>Add Experience
                            </button>
                        </div>
                        
                        <!-- Experience Forms Container -->
                        <div id="experience-forms">
                            {% for experience in cv.experiences.all %}
                            <div class="experience-form mb-4 p-3 border rounded">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Job Title *</label>
                                        <input type="text" class="form-control" name="experience_job_title" value="{{ experience.job_title }}" placeholder="Software Engineer" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Company *</label>
                                        <input type="text" class="form-control" name="experience_company" value="{{ experience.company }}" placeholder="Tech Company Inc." required>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Start Date</label>
                                        <input type="text" class="form-control" name="experience_start_date" value="{{ experience.start_date }}" placeholder="Jan 2020">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">End Date</label>
                                        <input type="text" class="form-control" name="experience_end_date" value="{{ experience.end_date }}" placeholder="Present">
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" name="experience_description" rows="3" placeholder="Describe your responsibilities and achievements...">{{ experience.description }}</textarea>
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Achievements</label>
                                        <textarea class="form-control" name="experience_achievements" rows="2" placeholder="Key achievements and impacts...">{{ experience.achievements }}</textarea>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-danger btn-sm remove-experience">
                                            <i class="fas fa-trash me-1"></i>Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% empty %}
                            <!-- Empty template for new experiences -->
                            <div class="experience-form mb-4 p-3 border rounded">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Job Title *</label>
                                        <input type="text" class="form-control" name="experience_job_title" placeholder="Software Engineer" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Company *</label>
                                        <input type="text" class="form-control" name="experience_company" placeholder="Tech Company Inc." required>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Start Date</label>
                                        <input type="text" class="form-control" name="experience_start_date" placeholder="Jan 2020">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">End Date</label>
                                        <input type="text" class="form-control" name="experience_end_date" placeholder="Present">
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" name="experience_description" rows="3" placeholder="Describe your responsibilities and achievements..."></textarea>
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Achievements</label>
                                        <textarea class="form-control" name="experience_achievements" rows="2" placeholder="Key achievements and impacts..."></textarea>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-danger btn-sm remove-experience">
                                            <i class="fas fa-trash me-1"></i>Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Education -->
                    <div class="form-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="section-header mb-0">
                                <i class="fas fa-graduation-cap me-2"></i>Education
                            </h3>
                            <button type="button" class="btn btn-add" id="add-education">
                                <i class="fas fa-plus me-1"></i>Add Education
                            </button>
                        </div>
                        
                        <!-- Education Forms Container -->
                        <div id="education-forms">
                            {% for education in cv.educations.all %}
                            <div class="education-form mb-4 p-3 border rounded">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Institution *</label>
                                        <input type="text" class="form-control" name="education_institution" value="{{ education.institution }}" placeholder="University Name" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Degree *</label>
                                        <input type="text" class="form-control" name="education_degree" value="{{ education.degree }}" placeholder="Bachelor of Science" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Field of Study</label>
                                        <input type="text" class="form-control" name="education_field_of_study" value="{{ education.field_of_study }}" placeholder="Computer Science">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Start Date</label>
                                        <input type="text" class="form-control" name="education_start_date" value="{{ education.start_date }}" placeholder="Aug 2018">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">End Date</label>
                                        <input type="text" class="form-control" name="education_end_date" value="{{ education.end_date }}" placeholder="May 2022">
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" name="education_description" rows="2" placeholder="Relevant coursework, achievements, honors...">{{ education.description }}</textarea>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-danger btn-sm remove-education">
                                            <i class="fas fa-trash me-1"></i>Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% empty %}
                            <!-- Empty template for new education -->
                            <div class="education-form mb-4 p-3 border rounded">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Institution *</label>
                                        <input type="text" class="form-control" name="education_institution" placeholder="University Name" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Degree *</label>
                                        <input type="text" class="form-control" name="education_degree" placeholder="Bachelor of Science" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Field of Study</label>
                                        <input type="text" class="form-control" name="education_field_of_study" placeholder="Computer Science">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">Start Date</label>
                                        <input type="text" class="form-control" name="education_start_date" placeholder="Aug 2018">
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label">End Date</label>
                                        <input type="text" class="form-control" name="education_end_date" placeholder="May 2022">
                                    </div>
                                    <div class="col-12 mb-3">
                                        <label class="form-label">Description</label>
                                        <textarea class="form-control" name="education_description" rows="2" placeholder="Relevant coursework, achievements, honors..."></textarea>
                                    </div>
                                    <div class="col-12 text-end">
                                        <button type="button" class="btn btn-danger btn-sm remove-education">
                                            <i class="fas fa-trash me-1"></i>Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Skills -->
                    <div class="form-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="section-header mb-0">
                                <i class="fas fa-tools me-2"></i>Skills
                            </h3>
                            <div>
                                <button type="button" class="btn btn-ai btn-sm me-2">
                                    <i class="fas fa-robot me-1"></i>AI Suggest Skills
                                </button>
                                <button type="button" class="btn btn-add btn-sm">
                                    <i class="fas fa-plus me-1"></i>Add Skill
                                </button>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <input type="text" class="form-control" placeholder="e.g., Python, JavaScript, Project Management">
                                <div class="form-text">Separate skills with commas</div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <select class="form-select">
                                    <option>Technical Skills</option>
                                    <option>Soft Skills</option>
                                    <option>Languages</option>
                                    <option>Certifications</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Projects -->
                    <div class="form-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="section-header mb-0">
                                <i class="fas fa-code me-2"></i>Projects
                            </h3>
                            <button type="button" class="btn btn-add">
                                <i class="fas fa-plus me-1"></i>Add Project
                            </button>
                        </div>
                        
                        <div class="project-form mb-4 p-3 border rounded">
                            <div class="row">
                                <div class="col-12 mb-3">
                                    <label class="form-label">Project Name *</label>
                                    <input type="text" class="form-control" placeholder="E-commerce Website">
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label">Technologies Used</label>
                                    <input type="text" class="form-control" placeholder="React, Node.js, MongoDB">
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label">Project URL</label>
                                    <input type="url" class="form-control" placeholder="https://github.com/yourusername/project">
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" rows="3" placeholder="Describe the project, your role, and outcomes..."></textarea>
                                    <button type="button" class="btn btn-ai btn-sm mt-2">
                                        <i class="fas fa-robot me-1"></i>AI Enhance Description
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Certifications & Achievements -->
                    <div class="form-section">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="section-header mb-0">
                                <i class="fas fa-trophy me-2"></i>Certifications & Achievements
                            </h3>
                            <button type="button" class="btn btn-add">
                                <i class="fas fa-plus me-1"></i>Add Certification
                            </button>
                        </div>
                        
                        <div class="achievement-form mb-4 p-3 border rounded">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Certification/Award Name *</label>
                                    <input type="text" class="form-control" placeholder="AWS Certified Developer">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Issuing Organization *</label>
                                    <input type="text" class="form-control" placeholder="Amazon Web Services">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Date Earned</label>
                                    <input type="month" class="form-control">
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label">Description</label>
                                    <textarea class="form-control" rows="2" placeholder="Details about the certification or achievement..."></textarea>
                                    <button type="button" class="btn btn-ai btn-sm mt-2">
                                        <i class="fas fa-robot me-1"></i>AI Enhance Description
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- References -->
                    <div class="form-section">
                        <h3 class="section-header">
                         <i class="fas fa-users me-2"></i>References
                        </h3>
            
                        <div class="references-form mb-4 p-3 border rounded">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Reference Name</label>
                                    <input type="text" class="form-control" placeholder="(e.g.Dr. someone buntu)">
                                </div>
                                <div class="col-md-6 mb-3">
                                     <label class="form-label">Position</label>
                                     <input type="text" class="form-control" placeholder="(e.g.Professor of Marketing and Projcet Management, Banking and finance Department  H.O.D-School of Business, etc.)">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Company/Institution</label>
                                    <input type="text" class="form-control" placeholder="(e.g.University of Zambia)">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-control" placeholder="(e.g.someone.buntu@unza.z)m)">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Phone</label>
                                    <input type="tel" class="form-control" placeholder="+260 123 456 789">
                                </div>
                                <div class="col-12 mb-3">
                                    <label class="form-label">Relationship</label>
                                    <input type="text" class="form-control" placeholder="(e.g.Former Professor, Supervisor, etc.)">
                                </div>
                            </div>
                        </div>
            
                        <!-- Option for "Available upon request" -->
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="availableUponRequest" checked>
                            <label class="form-check-label" for="availableUponRequest">
                                <strong>Available upon request</strong> - Include this standard phrase instead of detailed references
                            </label>
                        </div>
                        
                        <button type="button" class="btn btn-add btn-sm mt-3">
                            <i class="fas fa-plus me-1"></i>Add Another Reference
                        </button>
                    </div>

                    <!-- Save Button -->
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-primary btn-lg px-5 me-3 save-btn">
                            <i class="fas fa-save me-2"></i>Save CV
                        </button>
                        <button type="button" class="btn btn-success btn-lg px-5 download-btn">
                            <i class="fas fa-download me-2"></i>Download PDF
                        </button>
                    </div>
                </form> 
                <!-- End of form -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Work Experience dynamic form handling
        document.addEventListener('DOMContentLoaded', function() {
            const addExperienceBtn = document.getElementById('add-experience');
            if (addExperienceBtn) {
                addExperienceBtn.addEventListener('click', function() {
                    const formsContainer = document.getElementById('experience-forms');
                    const newForm = formsContainer.firstElementChild.cloneNode(true);
                    
                    // Clear input values in the new form
                    const inputs = newForm.querySelectorAll('input, textarea');
                    inputs.forEach(input => {
                        if (input.type !== 'submit' && input.type !== 'button') {
                            input.value = '';
                        }
                    });
                    
                    formsContainer.appendChild(newForm);
                });
            }

            // Remove experience form
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('remove-experience')) {
                    const form = e.target.closest('.experience-form');
                    const allForms = document.querySelectorAll('.experience-form');
                    if (allForms.length > 1) {
                        form.remove();
                    } else {
                        alert('You need at least one experience entry.');
                    }
                }
            });

            // Education dynamic form handling
            const addEducationBtn = document.getElementById('add-education');
            if (addEducationBtn) {
                addEducationBtn.addEventListener('click', function() {
                    const formsContainer = document.getElementById('education-forms');
                    const newForm = formsContainer.firstElementChild.cloneNode(true);
                    
                    // Clear input values in the new form
                    const inputs = newForm.querySelectorAll('input, textarea');
                    inputs.forEach(input => {
                        if (input.type !== 'submit' && input.type !== 'button') {
                            input.value = '';
                        }
                    });
                    
                    formsContainer.appendChild(newForm);
                });
            }

            // Remove education form
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('remove-education')) {
                    const form = e.target.closest('.education-form');
                    const allForms = document.querySelectorAll('.education-form');
                    if (allForms.length > 1) {
                        form.remove();
                    } else {
                        alert('You need at least one education entry.');
                    }
                }
            });
        });
    </script>
</body>
</html>